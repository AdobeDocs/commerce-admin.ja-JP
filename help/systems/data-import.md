---
title: データの読み込み
description: データの読み込みガイドラインと、データの読み込み操作の使用方法について説明します。
exl-id: caae8811-445e-49d4-aa90-226a355732bc
feature: Products, Customers, Data Import/Export
source-git-commit: 1c1327dbda76283ae28f761d1e523e049e0e492f
workflow-type: tm+mt
source-wordcount: '1504'
ht-degree: 0%

---

# データの読み込み

すべての商品タイプのデータをストアに読み込むことができます。 さらに、製品、詳細な価格データ、顧客データ、顧客アドレスデータ、製品画像をインポートできます。 インポートでは、次の操作をサポートしています。

- 追加/更新
- 置換
- 削除

## 読み込みガイドライン

### 新規エンティティ

- エンティティは、CSV ファイルで指定された属性値で追加されます。
- デフォルト値が設定されていない必須属性では、値がないか無効な値の場合、エンティティ（対応する行）をインポートできません。
- デフォルト値が設定されている必須属性の場合、エンティティ（対応する 1 行）がインポートされ、値がない場合または無効な値がある場合は、属性のデフォルト値が設定されます。
- 複合データが有効でない場合、エンティティ（対応する 1 つまたは複数の行）をインポートできません。

### 既存のエンティティ

- 複雑なデータではない属性の場合、インポート・ファイルの値は、不要な属性の空の値を含めて、既存の値を置き換えます。
- 必須の属性に値がない場合や、無効な値がある場合、既存の値は置き換えられません。
- エンティティの複合データが無効な場合は、インポート動作ドロップダウンメニューで「エンティティを削除」を選択した場合を除き、エンティティ（対応する行）をインポートできません。

### 複雑なデータ

インポートファイルで指定された属性が存在し、その値が定義済みの値のセットから派生する場合は、次の処理が適用されます。

- 値が定義された値のセットにまだ含まれていない場合、行をインポートして、属性のデフォルト値（定義されている場合）を設定できます。
- 値が定義済みのセットに既に含まれている場合、対応する行はインポートできません。
- 読み込みファイルに、システムで定義されていない属性名が指定されている場合、その属性名は作成されず、その値は読み込まれません。

### 無効なファイル

- すべての行が無効な場合、ファイルをインポートすることはできません。
- 既存のサービスデータまたは複雑なデータ名（`_<non-existing name>` 見出しを持つ列など）がインポートファイルで指定されている。

Adobe Commerceのインポートプロセスでは、UTF-8 でエンコードされ、バイト順マーク（BOM）を使用するファイルが正しく認識されない場合があります。 BOM を含むファイルは、インポート処理中に問題やエラーが発生する可能性があります。

## インポート操作

| 操作 | 説明 |
| --------- | ----------- |
| 追加/更新 | データベース内の既存のエントリの既存の製品データに、新しい製品データが追加されます。 `sku` 以外のすべてのフィールドは更新できます。<br><br> インポートデータで指定された新しい税クラスは自動的に作成されます。<br><br> インポートファイルで指定された新しい製品カテゴリが自動的に作成されます。<br><br> 読み込みファイルで指定された新しい SKU は自動的に作成されます <br><br>**_注意：_**&#x200B;製品の場合は、読み込みを通じて SKU を除くすべてのフィールドを更新できます。<br><br>**_ 重要：_** Web サイトやカテゴリなど、複数のフィールド値は、「_追加/更新_」読み込み動作では削除できません。 これらのフィールドが CSV ファイルにリストされていない場合、読み込み後もデータベースに残ります。 |
| 置換 | 既存の製品データは新しいデータに置き換えられます。<br><br>**_重要：_**&#x200B;データを置き換える際は、既存の製品データが消去され、システム内のすべての参照が失われるので、注意が必要です。<br><br> インポートデータの SKU が既存のエンティティの SKU と一致する場合、SKU を含むすべてのフィールドが削除され、CSV データを使用して新しいレコードが作成されます。 CSV ファイルが参照している SKU がデータベースに存在しない場合、エラーが発生します。 データを確認すると、エラーを表示できます。 |
| 削除 | データベースに存在するインポートデータのエンティティがデータベースから削除されます。<br><br> 削除では、SKU を除く、インポートデータ内のすべての列が無視されます。 データ内のその他すべての属性は無視できます。<br><br>CSV ファイルが参照している SKU がデータベースに存在しない場合、エラーが発生します。 データを確認すると、エラーを表示できます。 |

{style="table-layout:auto"}

## 読み込みプロセス

インポートファイルのサイズは、サーバー上の `php.ini` ファイルの設定によって決まります。 _インポート_ ページのシステムメッセージに、現在のサイズ制限が示されます。 デフォルトサイズは 2 MB です。

特殊文字（等号、記号より大きいまたは小さい、一重引用符と二重引用符、バックスラッシュ、パイプ、アンパサンド記号など）は、データ転送中に問題を引き起こす可能性があります。 このような特殊文字を正しく解釈するには、_エスケープシーケンス_ としてマークします。 例えば、データに `code="str"`、`code="str2"` などのテキスト文字列が含まれている場合、テキストを二重引用符で囲むように選択すると、元の二重引用符がデータの一部と理解されます。 システムが二重引用符の二重セットに遭遇すると、外側の二重引用符セットが実際のデータを囲んでいることを認識します。

製品データをインポートすると、新しい製品データがデータベース内の既存の製品データエントリに追加されます。 SKU を除くすべてのフィールドは、読み込みを通じて更新できます。 既存の製品データはすべて、読み込んだ新しいデータに置き換えられます。 データを置き換える際は注意が必要です。 既存の製品データがすべて消去され、システム内のすべての参照が失われます。

![&#x200B; データのインポート &#x200B;](./assets/import-options.png){width="600" zoomable="yes"}

### 手順 1：データを準備

1. _管理者_ サイドバーで、**[!UICONTROL System]**/_[!UICONTROL Data Transfer]_/**[!UICONTROL Import]**&#x200B;に移動します。

1. _読み込み設定_ で、**[!UICONTROL Entity Type]** を次のいずれかに設定します。

   - `Advanced Pricing`
   - `Products`
   - `Customer Finances`
   - `Customers and Addresses`
   - `Customers Main File`
   - `Customer Addresses`
   - `Stock Sources`

1. 「**[!UICONTROL Download Sample File]**」をクリックします。

1. Web ブラウザーのダウンロード先にあるエクスポートファイルを探して開きます。

   サンプルファイルには、製品タイプのプレースホルダーデータを含んだ列見出しが含まれています。

   ![&#x200B; データの読み込みサンプルファイル &#x200B;](./assets/data-export-sample-data.png){width="600" zoomable="yes"}

1. サンプルファイルの構造を調べ、それを使用して CSV インポートファイルを準備します。列見出しが正しく入力されていることを確認します。

1. インポートファイルのサイズが、メッセージに表示される制限を超えていないことを確認します。

   ![&#x200B; データインポートサイズ通知 &#x200B;](./assets/data-import-size-notification.png){width="600"}

1. 読み込みデータに製品画像へのパスが含まれている場合は、画像ファイルが適切な場所にアップロードされていることを確認してください。

   Commerce サーバーのデフォルトの場所は `pub/media/import` です。

   画像が外部サーバー上に存在する場合は、画像を含むディレクトリへの完全な URL を持っていることを確認してください。

### 手順 2：読み込み動作の選択

![&#x200B; データの読み込み動作 &#x200B;](./assets/data-import-import-behavior.png){width="600" zoomable="yes"}

1. **[!UICONTROL Import Behavior]** を次のいずれかに設定します。

   - `Add/Update` （製品の場合は、読み込みを通じて SKU を除くすべてのフィールドを更新できます。）
   - `Replace`
   - `Delete`

1. データのインポート時にエラーが発生したときの動作を確認するには、次のいずれかを選択します。

   - `Stop on Error`
   - `Skip error entries`

1. **[!UICONTROL Allowed Errors Count]**：読み込みがキャンセルされるまでに発生する可能性のあるエラー数を入力します。

   デフォルト値は 10 です。

1. **[!UICONTROL Field separator]** の場合は、デフォルト値のコンマ（`,`）を使用します。

1. **[!UICONTROL Multiple value separator]** の場合は、デフォルト値のコンマ（`,`）を使用します。

   CSV ファイルでは、デフォルトの区切り文字はコンマです。 別の文字を使用するには、CSV ファイルのデータが、指定した文字と一致していることを確認してください。

1. **[!UICONTROL Empty attribute value constant]** のデフォルト値 `_EMPTY_VALUE_` をそのまま使用します。

1. データ内にある特殊文字を _エスケープシーケンス_ として囲む場合は、「**[!UICONTROL Fields Enclosure]**」チェックボックスをオンにします。

### 手順 3：インポートファイルの特定

![&#x200B; データインポートファイル &#x200B;](./assets/data-import-file-to-import.png){width="600" zoomable="yes"}

1. 「**[!UICONTROL Choose File]**」をクリックして、インポートするファイルを選択します。

1. 読み込む準備をした CSV ファイルを見つけて、「**[!UICONTROL Open]**」をクリックします。

1. **[!UICONTROL Images File Directory]**：アップロードされた画像が保存されるCommerce サーバー上の場所の相対パスを入力します。

   例：`product_images`。

   >[!NOTE]
   >
   >Adobe CommerceおよびMagento Open Source `2.3.2` リリース以降、_[!UICONTROL Images File Directory]_&#x200B;で指定されたパスは、images ベースディレクトリ `<Magento-root-folder>/var/import/images` へのインポートを連結します。 例えば、`product_images` ファイルを `<Magento-root-directory>/var/import/images/product_images` フォルダーに配置します。 インポートイメージのベースディレクトリは、`\Magento\ImportExport\etc\config.xml` ファイルで設定できます。 リモート記憶域モジュールが有効な場合は、ファイルを `<remote-storage-root-directory>/var/import/images/product_images` フォルダーにインポートします。

   製品画像の読み込みについて詳しくは、[&#x200B; 製品画像の読み込み &#x200B;](data-import-product-images.md) を参照してください。

### 手順 4：インポートデータの確認

1. 右上隅の「**[!UICONTROL Check Data]**」をクリックします。

1. 検証プロセスが完了するまで、しばらくお待ちください。

   インポートデータが有効な場合は、次のメッセージが表示されます。

   ![&#x200B; 成功メッセージ – ファイルは有効です &#x200B;](./assets/data-import-validation-message.png){width="600"}

1. ファイルが有効な場合は、[**[!UICONTROL Import]**] をクリックします。

   それ以外の場合は、メッセージにリストされているデータの各問題を修正し、ファイルを再度インポートしてください。

1. エラーが発生しない限り、読み込みプロセスはデータの最後まで続行されます。

   検証結果にエラーメッセージが表示された場合は、データの問題を修正し、ファイルを再度読み込みます。

   ![&#x200B; エラーメッセージ - URL キーは既に存在します &#x200B;](./assets/data-import-validation-error-url-key-exists.png){width="600"}

   読み込みが完了すると、メッセージが表示されます。

## 履歴を読み込み

Commerceには、ストアに読み込まれたデータ（開始日時、ユーザー、実行時刻、読み込まれたファイルへのリンクなど）の記録が保持されます。 _実行時間_ は、インポートプロセスの期間です。

**_読み込み履歴を表示するには：_**

_管理者_ サイドバーで、**[!UICONTROL System]**/_[!UICONTROL Data Transfer]_/**[!UICONTROL Import History]**&#x200B;に移動します。

![&#x200B; データの読み込み履歴 &#x200B;](./assets/data-import-history.png){width="600" zoomable="yes"}

>[!NOTE]
>
>デフォルトでは、インポート履歴ファイルは `<Magento-root-directory>/var/import_history` フォルダーにあります。 リモート記憶域モジュールが有効な場合、インポート履歴ファイルは `<remote-storage-root-directory>/import_export/import_history` フォルダーにあります。

| フィールド | 説明 |
|--- |--- |
| [!UICONTROL ID] | 転送を指定するために使用される内部番号。 |
| [!UICONTROL Start Date & Time] | 転送が行われた特定の日時。 |
| [!UICONTROL User] | 転送を行った顧客。 |
| [!UICONTROL Imported file] | インポートしたファイルをダウンロードするためのリンクです。 |
| [!UICONTROL Error file] | 対応するエラーファイル。 |
| [!UICONTROL Execution Time] | インポートプロセスの時間間隔。 |
| [!UICONTROL Summary] | 作成、更新、削除された項目の数またはエラーメッセージ。 |

{style="table-layout:auto"}

_インポート/エラー_ ファイルをダウンロードするには、「**[!UICONTROL Download]**」をクリックします。
